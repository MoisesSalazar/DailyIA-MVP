import{m as N,I as T,_ as U}from"./Button-BGYz8Uub.js";import{s as o}from"./store-DRSfkTDY.js";import{o as M,e as x,a as y,k as O,r as z,n as H,d as _,y as D,z as C,p as q,b as d,u as t,w as k,f as P,F as Z}from"./app-Cb7TLskx.js";import{T as j,_ as S,a as G,b as J}from"./ModalDelete-CtfbLgsw.js";/* empty css                                                                       */import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-BiNuMcY8.js";function K(m,f){return M(),x("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[y("path",{d:"M6 3a3 3 0 0 0-3 3v2.25a3 3 0 0 0 3 3h2.25a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3H6ZM15.75 3a3 3 0 0 0-3 3v2.25a3 3 0 0 0 3 3H18a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3h-2.25ZM6 12.75a3 3 0 0 0-3 3V18a3 3 0 0 0 3 3h2.25a3 3 0 0 0 3-3v-2.25a3 3 0 0 0-3-3H6ZM17.625 13.5a.75.75 0 0 0-1.5 0v2.625H13.5a.75.75 0 0 0 0 1.5h2.625v2.625a.75.75 0 0 0 1.5 0v-2.625h2.625a.75.75 0 0 0 0-1.5h-2.625V13.5Z"})])}const Q={__name:"ButtonFloating",props:{position:{type:String,default:"bottom-right",validator:m=>["bottom-right","bottom-left","top-right","top-left"].includes(m)},step:{type:Number,default:1}},emits:["open"],setup(m,{emit:f}){const p=m,u=f,g=()=>{u("open")},v=O(()=>{switch(p.position){case"bottom-right":return"bottom-4 right-4";case"bottom-left":return"bottom-4 left-4";case"top-right":return"top-4 right-4";case"top-left":return"top-4 left-4";default:return"bottom-4 right-4"}});return(b,h)=>(M(),x("div",{class:H([v.value,"fixed p-1 cursor-pointer"]),onClick:g},[z(b.$slots,"default",{},void 0,!0)],2))}},W=R(Q,[["__scopeId","data-v-d15d18c3"]]);function X(){const m=_(""),f=_(!1),p=_(!1),u=_(!1),g=_([]),v=_([]),b=_([]),h=D([{value:"income",name:"Ingreso"},{value:"egress",name:"Egreso"}]),s=D({title:"Crear Transacci칩n",route:route("api.transactions.store"),method:"post",data:[{name:"wallet_id",value:o.wallet.id}],isLoading:!1,formData:{type:"",egress_id:"",income_id:"",amount:"",concept:""},fields:[{name:"type",label:"Tipo",field:"type",rules:["required","string"],type:"select",options:h,visible:!0},{name:"income_id",label:"Ingreso",field:"income_id",rules:["required","numeric"],type:"select",options:v,visible:!1},{name:"tag_id",label:"Categoria",field:"tag_id",rules:["required"],type:"select",options:g,visible:!1},{name:"egress_id",label:"Egreso",field:"egress_id",rules:["required","numeric"],type:"select",options:b,visible:!1},{name:"amount",label:"Monto",field:"amount",rules:["required","numeric"],type:"number",visible:!1},{name:"concept",label:"Concepto",field:"concept",rules:["required","string"],visible:!1}]}),c=function(e,n,i){e.forEach(A=>{A.name===n&&(A.visible=i)})},w=function(e){c(s.fields,"amount",e),c(s.fields,"concept",e)};C(()=>s.formData.type,e=>{e==="income"?(c(s.fields,"income_id",!0),c(s.fields,"tag_id",!1)):(c(s.fields,"tag_id",!0),c(s.fields,"income_id",!1),w(!1));for(const n in s.formData)s.formData.hasOwnProperty(n)&&n!=="type"&&(s.formData[n]="")});const V=function(e,n,i){e.hasOwnProperty(n)&&(e[n]=i)};C(()=>s.formData.income_id,e=>{w(!!e)});const E=e=>{const n=o.wallet.tags.find(i=>i.id===e);n&&n.egresses&&(b.value=[],n.egresses.forEach(i=>{b.value.push({value:i.id,name:i.name})}))};C(()=>s.formData.tag_id,e=>{e?(V(s.formData,"egress_id",null),E(e),c(s.fields,"egress_id",!0)):c(s.fields,"egress_id",!1)}),C(()=>s.formData.egress_id,e=>{w(!!e)});const r=D({title:"Editar Transacci칩n",route:"",method:"put",data:[{name:"wallet_id",value:o.wallet.id}],isLoading:!1,formData:{id:"",name:"",category:"",amount:0},fields:[{name:"name",label:"Nombre",field:"name",rules:["required","string"],visible:!0},{name:"category",label:"Categorias",field:"category",rules:["required","string"],type:"select",options:[],visible:!0},{name:"amount",label:"Monto",field:"amount",rules:["required","number"],visible:!0}]}),a=D({columns:[{name:"Concepto de transacci칩n",key:"concept",visible:!0,width:"20%"},{name:"Tipo",key:"type_spanish",visible:!0,width:"10%"},{name:"Ingreso/Egreso",key:"category",visible:!0,width:"10%"},{name:"Categoria",key:"tag.name",visible:!0,width:"10%"},{name:"Monto",key:"amount",visible:!0,width:"10%"},{name:"Fecha",key:"updated_at_formatted",visible:!0,width:"10%"}],isLoading:!0,data:[],actions:[{name:"Edit",icon:"PencilIcon",event:"edit",width:"5%"},{name:"Delete",icon:"TrashIcon",event:"delete",width:"5%"}]}),l=(e,n)=>{e==="edit"?(Object.keys(r.formData).forEach(i=>{r.formData[i]=n[i]}),r.route=route("api.transactions.update",{id:r.formData.id}),p.value=!0):e==="delete"&&(Object.keys(r.formData).forEach(i=>{r.formData[i]=n[i]}),u.value=!0)},$=()=>{f.value=!0},F=async e=>{o.wallet.transactions=o.wallet.transactions.filter(n=>n.id!==e),a.data=[...o.wallet.transactions]},I=async e=>{const n={...e,categoria:e.category};o.wallet.transactions.push(n),a.data=[...o.wallet.transactions]},B=async e=>{const n={...e,categoria:e.category};o.wallet.transactions=o.wallet.transactions.map(i=>i.id===e.id?n:i)},L=()=>{o.wallet.tags.forEach(e=>{g.value.push({value:e.id,name:e.name})}),o.wallet.incomes.forEach(e=>{v.value.push({value:e.id,name:e.name})}),a.data=o.wallet.transactions,console.log("Transactions:",a.data),a.isLoading=!1};return q(()=>{L()}),{message:m,showModalCreate:f,showModalEdit:p,showModalDelete:u,createdTransaction:s,editedTransaction:r,tableTransactions:a,handleAction:l,handleActionCreate:$,deleteTransaction:F,addTransaction:I,updateTransaction:B}}const Y={class:"flex flex-col md:flex-row gap-4"},ee={class:"grow grid grid-cols-2 md:grid-cols-5 gap-4 w-full"},te={class:"flex items-end"},ae={class:"grid grid-cols-1 gap-4 mt-5"},se={class:"grid grid-cols-1 gap-5"},ue={__name:"Transaction",setup(m){const f=[{value:1,name:"Enero"},{value:2,name:"Febrero"},{value:3,name:"Marzo"},{value:4,name:"Abril"},{value:5,name:"Mayo"},{value:6,name:"Junio"},{value:7,name:"Julio"},{value:8,name:"Agosto"},{value:9,name:"Septiembre"},{value:10,name:"Octubre"},{value:11,name:"Noviembre"},{value:12,name:"Diciembre"}],p=async()=>{try{const r=await N("GET",route("api.user"))}catch(r){console.error("Error connecting to API:",r)}};q(()=>{p()});const{showModalCreate:u,showModalEdit:g,showModalDelete:v,createdTransaction:b,editedTransaction:h,tableTransactions:s,handleAction:c,deleteTransaction:w,addTransaction:V,updateTransaction:E}=X();return(r,a)=>(M(),x(Z,null,[y("div",Y,[y("div",ee,[d(T,{modelValue:t(o).year,"onUpdate:modelValue":a[0]||(a[0]=l=>t(o).year=l),type:"number",label:"A침o",class:"w-full"},null,8,["modelValue"]),d(T,{modelValue:t(o).month,"onUpdate:modelValue":a[1]||(a[1]=l=>t(o).month=l),type:"select",label:"Mes",options:f,class:"w-full"},null,8,["modelValue"]),d(T,{modelValue:t(o).essential_needs_percentage,"onUpdate:modelValue":a[2]||(a[2]=l=>t(o).essential_needs_percentage=l),type:"number",label:"50% Necesidades Esenciales",class:"w-full"},null,8,["modelValue"]),d(T,{modelValue:t(o).savings_percentage,"onUpdate:modelValue":a[3]||(a[3]=l=>t(o).savings_percentage=l),type:"number",label:"20% Ahorros",class:"w-full"},null,8,["modelValue"]),d(T,{modelValue:t(o).discretionary_spending_percentage,"onUpdate:modelValue":a[4]||(a[4]=l=>t(o).discretionary_spending_percentage=l),type:"number",label:"30% Gastos Discrecionales",class:"w-full"},null,8,["modelValue"])]),y("div",te,[d(U,{onClick:p},{default:k(()=>a[9]||(a[9]=[P("Filtrar")])),_:1})])]),y("div",ae,[y("div",se,[d(j,{isLoading:t(s).isLoading,data:t(s).data,columns:t(s).columns.filter(l=>l.visible),actions:t(s).actions,onAction:t(c),showCreateButton:!1},null,8,["isLoading","data","columns","actions","onAction"])])]),d(W,{onOpen:a[5]||(a[5]=l=>u.value=!0),position:"bottom-right",class:"h-10 w-10 bg-purple-600 hover:bg-purple-800 text-white font-bold shadow-lg flex items-center justify-center rounded-lg"},{default:k(()=>[d(t(K),{class:"h-12 w-12 text-white"})]),_:1}),d(S,{show:t(u),onClose:a[6]||(a[6]=l=>u.value=!1),created:t(b),table:t(s).data,onCreated:t(V)},null,8,["show","created","table","onCreated"]),d(G,{show:t(g),onClose:a[7]||(a[7]=l=>g.value=!1),edited:t(h),table:t(s).data,onUpdate:t(E)},null,8,["show","edited","table","onUpdate"]),d(J,{show:t(v),onClose:a[8]||(a[8]=l=>v.value=!1),route:r.route("api.transactions.destroy",{id:t(h).formData.id}),name:t(h).formData.name,onDelete:t(w),selected:t(h).formData},null,8,["show","route","name","onDelete","selected"])],64))}};export{ue as default};
